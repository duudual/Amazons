# 亚马逊棋AI - Alpha-Beta剪枝实现

## 概述
本次更新将AmazonAb目录下的程序从蒙特卡洛树搜索(MCTS)完全切换为Alpha-Beta剪枝算法，并实现了多项性能优化。

## 主要改进

### 1. 算法切换：从MCTS到Alpha-Beta剪枝
- **移除**: 完整的MCTS实现（MCTSNode结构、选择、扩展、模拟、回溯阶段）
- **新增**: Alpha-Beta剪枝搜索算法，包含：
  - 迭代加深搜索（Iterative Deepening）
  - 完整的alpha-beta剪枝逻辑
  - 置换表（Transposition Table）用于缓存已计算的局面

### 2. 改进的评估函数
原有的`quickScore`函数仅考虑领地控制，新的`evaluateBoard`函数考虑了多个因素：

#### 评估指标及权重：
1. **领地控制** (权重: 100) - 最重要的因素
   - 计算双方到每个空位的距离差
   - 近距离可控区域(距离≤2)额外加分(权重: 20)
   
2. **移动能力** (权重: 5)
   - 计算每个棋子可以到达的位置数量
   - 行动力越强，分数越高

3. **中心控制** (权重: 3)
   - 控制中心区域的空位更有价值
   - 距离中心越近的空位，如果被控制则加分越多

4. **棋子位置** (权重: 2)
   - 更倾向于将棋子放在中心位置
   - 提高棋子的全局影响力

#### 终局判定：
- 准确判断胜负：无法移动的一方直接判负
- 双方都无法移动时，比较领地数量判定胜负
- 返回极大/极小值表示必胜/必败局面

### 3. 性能优化

#### 3.1 置换表（Transposition Table）
- **大小**: 2^20个条目（约100万条）
- **功能**: 缓存已评估过的局面，避免重复计算
- **包含信息**:
  - Zobrist哈希值（唯一标识局面）
  - 搜索深度
  - 评分
  - 最佳走法
  - 节点类型（精确值/上界/下界）

#### 3.2 Zobrist哈希
- 快速计算棋盘的唯一哈希值
- 增量更新：每次走棋只需异或操作，O(1)时间复杂度
- 考虑了棋子位置和当前行棋方

#### 3.3 移动排序（Move Ordering）
优先级顺序：
1. **置换表最佳走法** - 最高优先级
2. **启发式评分** - 评估每个走法的局面得分
3. **中心位置加分** - 倾向于向中心移动

良好的移动排序能够：
- 更早触发beta剪枝
- 显著减少搜索节点数
- 提高搜索效率

### 4. 搜索策略

#### 迭代加深搜索
- 从深度1开始逐步增加到设定的最大深度
- 优点：
  - 浅层搜索结果可用于深层搜索的排序
  - 保证在时间限制内有可用的走法
  - 便于实现时间控制

#### 默认搜索深度
- **无UI版本**: 深度4（竞赛版本）
- **GUI版本**: 深度4（可实时调整）

搜索深度可以根据情况调整：
- 开局：可以使用更深的搜索
- 中盘：保持平衡
- 残局：走法较少，可以增加深度

## 文件说明

### AmazonAlphabeta.cpp
- 无UI的命令行版本
- 用于OJ平台或命令行对战
- 输入输出格式符合比赛要求

### AmazonAlphabeta_gui.cpp  
- 带SFML图形界面的版本
- 支持人机对战
- 实时显示搜索深度和评分
- 快捷键：
  - S: 保存游戏
  - L: 加载游戏
  - A: 手动触发AI走棋
  - C: 切换人类执子颜色
  - R: 重置游戏

## 性能对比

### MCTS版本
- 需要大量模拟次数（80000次）
- 每次决策时间较长
- 评估不够精确（随机模拟）
- 内存开销大（树结构）

### Alpha-Beta版本
- 搜索深度4可以看到未来4步
- 决策速度快（剪枝效率高）
- 评估更准确（多因素评估函数）
- 内存开销小（仅置换表）

## 编译说明

### 无UI版本
```bash
# 使用MSVC (Windows)
cl /std:c++17 /EHsc AmazonAlphabeta.cpp

# 使用GCC/G++ (Linux/Mac)
g++ -std=c++17 -O3 AmazonAlphabeta.cpp -o AmazonAlphabeta
```

### GUI版本
```bash
# 使用MSVC + SFML (Windows)
cl /std:c++17 /EHsc AmazonAlphabeta_gui.cpp /I D:\lib\SFML-2.5.1\include /link /LIBPATH:D:\lib\SFML-2.5.1\lib sfml-graphics.lib sfml-window.lib sfml-system.lib

# 或使用VS Code任务（已配置）
# 按Ctrl+Shift+B选择对应的构建任务
```

## 未来优化方向

1. **多线程搜索**: 利用多核CPU并行搜索不同的分支
2. **开局库**: 预存开局定式，快速度过开局阶段
3. **残局表**: 预计算特定残局的最优解
4. **静态搜索**: 在叶节点进行额外的平静搜索
5. **自适应深度**: 根据局面复杂度动态调整搜索深度
6. **机器学习评估**: 使用神经网络替代手工评估函数

## 参考资料

- Alpha-Beta剪枝算法：经典的游戏树搜索算法
- 置换表：国际象棋和围棋程序的标准优化
- Zobrist哈希：快速计算棋盘哈希的经典方法
- 迭代加深：时间受限的游戏AI常用策略

## 更新日期
2025年12月25日
